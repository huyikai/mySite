---
date: 2022-02-26
head:
  - - meta
    - name: description
      content: 前端性能优化
  - - meta
    - name: keywords
      content: 前端,前端优化,前端性能优化,前端首屏优化,首屏加载优化,前端性能
---

# 前端性能优化

## 网络传输性能优化

### 1. 使用 HTTP2

> HTTP2 相对于 HTTP1 进行了下面的优化：

- 二进制分帧层
- 多路复用
- 首部压缩
- 请求优先级
- 服务器推送
- 流量控制

### 2. 资源打包压缩

> 资源打包压缩主要是通过 webpack 压缩以下内容：

- 压缩 JS 代码：通过 webpack 的 production 模式压缩 JS 代码。
- 压缩 HTML 代码：使用 html-webpack-plugin 的 minify 进行压缩。
- 压缩 CSS 代码：使用 cssnano 压缩 css，在 postcss.config.js 中进行配置。

### 3. 图片资源优化

> 在网络传输中真正占用大量网络资源的不是文件而是图片，如果对图片进行了优化，可以看到立竿见影的效果。主要优化措施如下：

- 在 html 中尽量不要放图片。
- 使用雪碧图：雪碧图可以减少请求的次数。
- 使用字体图标：字体图片能够像图片一样工作，但是资源占用和图片请求比起来小很多。
- 使用 webp：webp 格式的图片相对根据国家节省网络带宽。

### 4. 使用 CDN

> CDN 指的是在网络不同地点部署节点服务器，将源站内容分发至所有 CDN 节点，使得用户可以就近获得所需内容。CDN 提高了网站的响应速度、降低了延迟。

### 5. 使用预加载

> 当一个页面加载时，可能会加载很多第三方资源，但是这些资源的优先级是不同的，一些重要资源需要提前进行获取，因此我们可以使用 link 标签来进行 DNS 预解析、预加载、预渲染来管理页面资源的加载。

### 6. 减少 DNS 查找

> 尽量将资源放在同一域名下面，因为域名越少，DNS 查询就会越少。

### 7. 发送请求时使用防抖和节流策略

> 防抖节流可以避免短时间内发送过多的重复请求。

## 页面渲染性能优化

### 1. 减少重排和重绘的发生

- 重排：指的是元素布局发生修改，导致页面重新排列。
- 重绘：所有对元素的视觉表现属性的修改，都会引发重绘。

> 重排和重绘都会影响性能，要想提高网页性能尽可能降低重排和重绘的频率。重排是由 CPU 处理的，而重绘是由 GPU 处理的，GPU 的处理效率要相对更高，重排一定发生重绘，但是重绘不一定引起重排，所以要尽可能的降低重排和重绘的发生。

### 2. DOM 元素离线更新

> 当对 DOM 元素进行操作的时候，尽量使用 documentFragment 对象进行离线操作，待元素组装完成之后再一次插入页面。

### 3. 避免 CSS、JS 阻塞

> CSS 资源优于 JS 资源的引入，JS 应当尽量少影响 DOM 的构建。

## 经典问题

### RQ1：首屏加载如何优化？

> 主要方法包括以下步骤：

1. 动态加载路由

> 配置路由的时候，以函数的形式加载路由，只有在解析给定的路由时，才会加载路由。

1. 合理使用缓存

> 设置强缓存、协商缓存、localstorage 等。

1. UI 框架按需加载

> 不要引入整个 UI 库，尽量进行按需加载。

1. 避免重复加载组件

> 可以使用 webpack 将多次使用的包抽离出来，放入公共依赖文件，避免重复加载组件。

1. 压缩图片资源

> 雪碧图、字体图标、webp 等。

1. 开启 Gzip 压缩
2. 使用 SSR 服务端渲染

> 组件或页面通过服务器生成 html 字符串，再发送到浏览器。
